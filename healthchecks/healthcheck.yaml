- description: |
    Performs an automatic healthcheck service
    
    This is <b>HealthCheck</b> list for DevOps Portal
    
    <a href="/">Top</a>
    
    1. Haproxy Healthcheck
    2. Ldap Healthcheck
    3. ElasticSearch Healthcheck
    4. etc... 
    
    [Doc link](https://bitbucket.org/snovikov/devops-portal-pytest/src)
  name: DevopsPortal_Health
  executionEnabled: true
  group: systools
  loglevel: INFO
  nodeFilterEditable: false
  nodefilters:
    dispatch:
      excludePrecedence: true
      keepgoing: true
      rankOrder: ascending
      threadcount: 1
    filter: tags:cicd
  nodesSelectedByDefault: true
  options:
  - name: HEALTHCHECK_REPO
    value: https://github.com/naumvd95/test-health.git
  - name: CONFIG_PATH
    value: etc/config.json
  - name: HEALTHCHECK
    value: healthcheck
    values:
    - elasticsearch_healthcheck
    - rundeck_healthcheck
    - ldap_healthcheck
  scheduleEnabled: true
  sequence:
    commands:
    - exec: git clone ${option.HEALTHCHECK_REPO}
    - scriptfile: /var/rundeck/projects/cicd/scm/scripts/env_setup.sh
    keepgoing: false
    pluginConfig:
      WorkflowStrategy:
        node-first: null
    strategy: node-first
